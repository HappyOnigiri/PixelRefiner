# Pixel Refiner

<video src=".github/assets/demo.mp4" width="100%" controls autoplay loop muted></video>

**Pixel Refiner** は、AI生成などで作られたドット絵（ピクセルアート）を、素材として実用的なクオリティに最適化するWebツールです。
アンチエイリアスの除去、グリッドの自動検出、背景透過などの処理をブラウザ上で高速に行います。

![License](https://img.shields.io/badge/license-MIT-blue)
![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue)
![Vite](https://img.shields.io/badge/Vite-5.0-646CFF)

## ✨ 特徴

AIで生成したドット絵は、しばしば「ドットがぼやけている（アンチエイリアスがかかっている）」「グリッドがずれている」「背景が不透明」といった問題を抱えています。Pixel Refinerはこれらを解決します。

- **アンチエイリアス除去**: ぼやけたエッジをシャープなドット絵に変換します。
- **グリッド自動検出**: 元画像のドットサイズ（ピクセルグリッド）を自動で検出し、最適なサイズに再サンプリングします。
- **高度な背景透過**:
  - 四隅の色を基準とした自動透過
  - 許容差（Tolerance）の調整
  - 「内側の背景」（ドーナツの穴など）の透過
  - 浮きノイズ（孤立点）の自動除去
- **自動トリム**: 余白を自動で削除し、コンテンツサイズに合わせます。
- **サイズ強制変換**: 指定した縦横ピクセル数への強制リサイズも可能です。
- **拡大エクスポート**: ゲームエンジン等での利用に合わせて、x2, x4, ... x32 倍に拡大してダウンロードできます。

## 🚀 使い方

1. アプリケーションを開きます（ローカル起動またはデプロイ先）。
2. ドロップエリアに画像をドラッグ＆ドロップ（またはクリックして選択）します。
3. **「処理を実行」** ボタンを押すと、最適化されたドット絵が生成されます。
4. 必要に応じて設定パネルで以下のパラメータを調整できます：
    - **減色ステップ**: グリッド検出の感度調整
    - **サンプル範囲**: ドット色決定時の参照範囲
    - **背景色の許容差**: 背景とみなす色の幅
    - **各種除去オプション**: 内側透過、浮きノイズ除去など
5. 処理結果が良ければ **「ダウンロード」** ボタンで保存します（右の▼ボタンから拡大率を選択可能）。

## 🛠️ 開発

このプロジェクトは TypeScript + Vite で構築されています。

### 前提条件

- Node.js (推奨: v18以上)
- npm

### インストール

```bash
git clone https://github.com/HappyOnigiri/PixelRefiner.git
cd PixelRefiner
npm install
```

### 開発サーバーの起動

```bash
npm run dev
```

ブラウザで `http://localhost:5173` にアクセスしてください。

### ビルド

```bash
npm run build
```

`dist` ディレクトリに静的ファイルが出力されます。

### テスト

コアロジック（画像処理部分）の単体テストを実行します。

```bash
npm test
```

## 📂 プロジェクト構成

- `src/browser/`: ブラウザ用UIロジック、メインエントリーポイント
- `src/core/`: 画像処理のコアアルゴリズム（グリッド検出、リサンプリング、透過処理など）
- `src/shared/`: 型定義、定数設定
- `test/`: テストコードとフィクスチャ画像

## 📄 ライセンス

このプロジェクトは [MIT License](./LICENSE) の下で公開されています。
